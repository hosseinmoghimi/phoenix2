<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        let year = function (a) {
            ye = a.substring(0, 4)
            return ye
        }
        let month = function (a) {
            ye = a.substring(5, 7)
            return ye
        }
        let day = function (a) {
            ye = a.substring(8, 10)
            return ye
        }

        let data1 = JSON.parse(`{{projects_s|escapejs}}`)


        google.charts.load('current', { 'packages': ['gantt'] });
        google.charts.setOnLoadCallback(drawChart);
        var data =[]
        function drawChart() {

            data = new google.visualization.DataTable();
            data.addColumn('string', 'Task ID');
            data.addColumn('string', 'Task Name');
            data.addColumn('string', 'Resource');
            data.addColumn('date', 'Start Date');
            data.addColumn('date', 'End Date');
            data.addColumn('number', 'Duration');
            data.addColumn('number', 'Percent Complete');
            data.addColumn('string', 'Dependencies');
            data1.forEach(element => {
                data.addRow(
                    [element.title, element.title, element.get_resource,
                    new Date(year(element.start_date), month(element.start_date), day(element.start_date)),
                    new Date(year(element.end_date), month(element.end_date), day(element.end_date)),
                        null, element.percent, null]

                );
            });


            var options = {
                height: 400,
                gantt: {
                    trackHeight: 30
                }
            };

            var chart = new google.visualization.Gantt(document.getElementById('chart_div'));

            chart.draw(data, options);
        }


    </script>
</head>

<body>
    <div class="container">
        <h3 class="text-center my-5">
            <a href="{{project.get_absolute_url}}">

                {{project.title}}
            </a>

        </h3>



        <div class="text-center">

            <div id="chart_div"></div>
        </div>
    </div>

</body>

</html>